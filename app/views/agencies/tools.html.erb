<%= show_errors('An error occurred...', flash[:alert]) %>
<%= show_notice(flash[:notice]) %>
<% header = "Client: #{collection_select(:client, :id, @client_list, :id, :name, :html_options => {:id => 'client_id'})}&nbsp;<input type=\"button\" value=\"Create Contract\" onclick=\"dashboard_nav('create_contract', '#{session[:agencyId].to_s}');\" />&nbsp;<input type=\"button\" value=\"Add Approver\" onclick=\"dashboard_nav('add_approver', '#{session[:agencyId].to_s}');\" />&nbsp;<input type=\"button\" value=\"Invite Worker\" onclick=\"dashboard_nav('invite_worker', '#{session[:agencyId].to_s}');\" />" %>
<div id="nav-bar-box">
<%= two_column_nav_bar_layout2("Tools and Quick Search", "") %>
</div>
<div id="blue-box2">
    <div class="padder">
    	<table cellpadding="4" cellspacing="3" style="border-collapse:collapse;">
  <tr>
  	<table width="100%" cellpadding="2" cellspacing="0">
    <td width="33.3%" style="border-right: black solid 1px; vertical-align:top">
      <table width="100%" cellpadding="0" cellspacing="0">
        <tr><td class="header" colspan="2">Client Tools</td></tr>
        <tr>
          <td style="padding-top: 4px"><%= collection_select(:client, :id, @client_list, :id, :name, {}, {:id => 'client_id', :style => "width: 100%"})  %></td>
        </tr>
        <tr>
          <td align="right"><input type="button" value="Add New Contract" onclick="dashboard_nav('create_contract', '<%=session[:agencyId].to_s %>');" /></td>
        </tr>
        <tr>
          <td align="right"><input type="button" value="Add Approver" onclick="dashboard_nav('add_approver', '<%=session[:agencyId].to_s %>');" /></td>
        </tr>
		
      </table>
    </td>
    <td style="border-right: black solid 1px;vertical-align:top">
      <table width="100%" cellpadding="0" cellspacing="0">
      	<tr><td class="header" colspan="2">Worker Tools</td></tr>
		<tr>
			<td style="padding-top: 4px"><%= select_tag(:contractor_id, options_for_select(@active_workers))  %></td>
		</tr>
        <tr>
			<td align="right"><input type="button" value="Invite New Worker(s)" onclick="dashboard_nav('invite_worker', '<%=session[:agencyId].to_s %>');" /></td>
		</tr>
      </table>
    </td>
    <td width="33.3%" valign="top">
      <% form_tag('tools', :method => :get) do %>
      <table width="100%" cellpadding="0" cellspacing="0">
      	<tr><td class="header" colspan="2">Search</td></tr>
        <tr><td style="padding-top: 4px"><input type="text" name="criteria" style="width: 97%" /></td></tr>
		<tr><td align="right">&nbsp;<%= submit_tag('go') %></td></tr>
      </table>
	  <% end %>
    </td>
  </tr>
          
        </table>
	</div>
	</div>
	
<div id="blue-box">
    <div class="padder">

<div>
	<table cellpadding="2" cellspacing="0" width="100%">
	<% if !@criteria %>
	<tr>
		<td colspan="2" align="center">No search results to display</td>
	</tr>
	<% else%>
	
	<% if @results.length == 0 %>
		<tr><td>Nothing found matching criteria</td></tr>
	<% else %>
	<tr>
		<td class="header row_border_right"><%= sort_link 'Type', :type, @selected_column %></td>
		<td class="header row_border_right"><%= sort_link 'Start Date', :start_date, @selected_column %></td>
		<td class="header row_border_right"><%= sort_link 'End Date', :end_date, @selected_column %></td>
		<td class="header row_border_right"><%= sort_link 'Worker', :contractor_name, @selected_column %></td>
		<td class="header row_border_right"><%= sort_link 'Ref', :ref, @selected_column %></td>
		<td class="header"><%= sort_link 'Status', :status, @selected_column %></td>
	</tr>
	<% for result in @results %>
	<tr>
		<td class="row_border_right"><img src="<%= result.icon %>" alt="" class="small_icon" title="<%= result.tooltip %>" /></td><td class="row_border_right"><%= result.start_date.to_formatted_s(:uk_date) %></td><td class="row_border_right"><%= result.end_date.to_formatted_s(:uk_date) %></td><td class="row_border_right"><%= "#{result.contractor_name}" %></td><td class="row_border_right"><%= result.ref %></td><td><%= result.status %></td>
	</tr>
	<% end%>
	<% end%>
			</table>
						<!-- contracts -->
				<% end%>
				
			
</div>
</div>
</div>
<script type="text/javascript">
	var navbarbox = RUZEE.ShadedBorder.create({corner:8, border:1});
    navbarbox.render('nav-bar-box');
    var bluebox = RUZEE.ShadedBorder.create({corner:8, border:1});
    bluebox.render('blue-box');
	var bluebox2 = RUZEE.ShadedBorder.create({corner:8, border:1});
    bluebox2.render('blue-box2');

		
</script>